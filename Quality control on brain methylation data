# List of file paths
  file_paths <- c("PATHS")  
  
  
  # Lists to store results per file
  average_coverage_per_file <- numeric()
  sites_with_10_reads_per_file <- numeric()
  
  # Loop
  for (fname in file_paths) {
    # Get the size of the file
    N <- file.info(fname)$size
    
    # Read binary data from the file
    content <- matrix(readBin(fname, "integer", N, size = 1, signed = FALSE), N / 2, 2, byrow=TRUE)
    
    # Calculate coverage
    coverage <- sum(content[, 2]) / length(content[, 1])
    average_coverage_per_file <- c(average_coverage_per_file, coverage)
    
    # Calculate number of sites with at least 10 reads
    sites_with_10_reads <- sum(content[, 2] >= 10)
    sites_with_10_reads_per_file <- c(sites_with_10_reads_per_file, sites_with_10_reads)
    
    # Print results for the current file
    print(paste("File:", fname))
    print(paste("Average Coverage:", coverage))
    print(paste("Number of Sites with at least 10 reads:", sites_with_10_reads))
  }
  
  
  # Data frame with results
  results_df <- data.frame(File = file_paths,
                           Average_Coverage = average_coverage_per_file,
                           Sites_with_10_reads = sites_with_10_reads_per_file)
  
  # Write the data frame to a CSV file
  write.csv(results_df, "results.csv", row.names = FALSE)
